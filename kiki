SELECT 
    papf.person_id,
    papf.full_name         AS employee_name,
    papf.employee_number   AS employee_number,
    hou.organization_id,
    hou.name               AS department_name
FROM
    fnd_user fu,
    per_all_people_f papf,
    per_all_assignments_f paaf,
    hr_organization_units hou
WHERE
    fu.employee_id = papf.person_id
AND paaf.person_id = papf.person_id
AND hou.organization_id = paaf.organization_id
AND fu.user_name = :p_username
-- current person record
AND SYSDATE BETWEEN papf.effective_start_date AND papf.effective_end_date
-- current assignment record (primary only)
AND SYSDATE BETWEEN paaf.effective_start_date AND paaf.effective_end_date
AND NVL(paaf.primary_flag, 'N') = 'Y';
